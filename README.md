# π—οΈ κ±΄μ¶• λ„λ©΄ RAG μ§μ μ‹μ¤ν…

κ±΄μ¶• λ„λ©΄ PDF/DWG νμΌμ—μ„ λ©”νƒ€λ°μ΄ν„°λ¥Ό μ¶”μ¶ν•κ³  OpenAI κΈ°λ° RAG (Retrieval-Augmented Generation) μ‹μ¤ν…μ„ ν†µν•΄ μ§€λ¥μ μΈ μ§μμ‘λ‹µμ„ μ κ³µν•λ” ν†µν•© μ‹μ¤ν…

## π― μ£Όμ” κΈ°λ¥

- **λ©€ν‹°ν¬λ§· μ§€μ›**: PDF, DWG, DXF νμΌ μλ™ μ²λ¦¬
- **OpenAI μ„λ² λ”©**: `text-embedding-3-small` λ¨λΈλ΅ κ³ ν’μ§ λ²΅ν„° κ²€μƒ‰
- **ChromaDB λ²΅ν„° μ €μ¥**: ν”„λ΅μ νΈλ³„ μ»¬λ ‰μ… κ΄€λ¦¬
- **CLI + λ…ΈνΈλ¶ ν†µν•©**: λ…λ Ήμ¤„ λ„κµ¬μ™€ Jupyter λ…ΈνΈλ¶ μΈν„°νμ΄μ¤
- **μ΄λ―Έμ§€ μ—°λ™**: κ²€μƒ‰ κ²°κ³Όμ™€ κ΄€λ ¨λ λ„λ©΄ μ΄λ―Έμ§€ μλ™ ν‘μ‹
- **LangSmith μ¶”μ **: AI λ¨λΈ μ„±λ¥ λ¨λ‹ν„°λ§ λ° λ””λ²„κΉ…

## π—οΈ μ‹μ¤ν… μ•„ν‚¤ν…μ²

```
PDF/DWG λ¬Έμ„ β†’ λ©”νƒ€λ°μ΄ν„° μ¶”μ¶ β†’ OpenAI μ„λ² λ”© β†’ ChromaDB μ €μ¥
                                                    β†“
μ‚¬μ©μ μ§μ β†’ λ²΅ν„° κ²€μƒ‰ β†’ κ΄€λ ¨ λ¬Έμ„ + μ΄λ―Έμ§€ β†’ OpenAI LLM β†’ λ‹µλ³€
                                                    β†‘
                                           LangSmith μ¶”μ 
```

## β΅ ν•µμ‹¬ νΉμ§•

- **ν”„λ΅μ νΈλ³„ κ΄€λ¦¬**: κ° κ±΄μ¶• ν”„λ΅μ νΈλ¥Ό λ…λ¦½μ μΈ μ»¬λ ‰μ…μΌλ΅ κ΄€λ¦¬
- **ν†µν•© μΈν„°νμ΄μ¤**: CLI λ„κµ¬μ™€ λ…ΈνΈλ¶μ„ ν†µν• μ μ—°ν• μ‚¬μ©
- **μ΄λ―Έμ§€ μλ™ μ—°λ™**: κ²€μƒ‰λ λ„λ©΄κ³Ό κ΄€λ ¨λ PNG μ΄λ―Έμ§€ μλ™ ν‘μ‹
- **μ„±λ¥ μ¶”μ **: μ‹¤ν–‰ μ‹κ°„, μ„±κ³µλ¥  λ“± μƒμ„Έν• μ„±λ¥ λ¶„μ„

## π€ λΉ λ¥Έ μ‹μ‘

### 1. ν™κ²½ μ„¤μ •

```bash
# κ°€μƒν™κ²½ μƒμ„± λ° ν™μ„±ν™”
python -m venv .venv
source .venv/bin/activate  # Linux/Mac
.venv\Scripts\activate     # Windows

# μμ΅΄μ„± μ„¤μΉ
pip install -r requirements.txt
```

### 2. ν™κ²½λ³€μ μ„¤μ •

```bash
# .env νμΌ μƒμ„±
cp .env.example .env

# .env νμΌμ—μ„ λ‹¤μ μ„¤μ • ν•„μ:
# - OPENAI_API_KEY: OpenAI API ν‚¤
# - DEFAULT_LLM_PROVIDER: openai
# - DEFAULT_EMBEDDING_PROVIDER: openai
```

### 3. λ°μ΄ν„° μ¤€λΉ„

```bash
# PDF/DWG νμΌλ“¤μ„ uploads/ ν΄λ”μ— ν”„λ΅μ νΈλ³„λ΅ μ •λ¦¬
# μ: uploads/λ¶€μ‚°μ¥μ•_ν”„λ΅μ νΈλ„λ©΄/μ§€ν•μ£Όμ°¨μ¥_κµ¬μ΅°ν‰λ©΄λ„.pdf
#     uploads/λ¶€μ‚°μ¥μ•_ν”„λ΅μ νΈμ •λ³΄/μ„¤κ³„κ°μ”.pdf
```

## π’΅ μ‚¬μ©λ²•

### 1. λ©”νƒ€λ°μ΄ν„° μ¶”μ¶

```bash
# PDF/DWG νμΌμ—μ„ λ©”νƒ€λ°μ΄ν„° μ¶”μ¶
python extract_metadata_unified.py --project λ¶€μ‚°μ¥μ•_ν”„λ΅μ νΈλ„λ©΄

# LLM κΈ°λ° Self-Query ν•νƒλ΅ λ³€ν™
python extract_metadata_unified.py --project λ¶€μ‚°μ¥μ•_ν”„λ΅μ νΈλ„λ©΄ --convert_to_self_query
```

### 2. RAG λ°μ΄ν„°λ² μ΄μ¤ κµ¬μ¶•

```bash
# λ¨λ“  ν”„λ΅μ νΈ RAG DB κµ¬μ¶•
python build_rag_db_v2.py

# νΉμ • ν”„λ΅μ νΈλ§ μ²λ¦¬
python build_rag_db_v2.py --project λ¶€μ‚°μ¥μ•_ν”„λ΅μ νΈλ„λ©΄

# κΈ°μ΅΄ μ»¬λ ‰μ… λ©λ΅ ν™•μΈ
python build_rag_db_v2.py --list
```

### 3. RAG μ§μ μ‹¤ν–‰

```bash
# κΈ°λ³Έ μ§μ
python query_rag.py "μ§€ν•μ£Όμ°¨μ¥ κµ¬μ΅°ν‰λ©΄λ„λ¥Ό μ°Ύμ•„μ£Όμ„Έμ”"

# νΉμ • ν”„λ΅μ νΈ λ€μƒ μ§μ
python query_rag.py "κµ¬μ΅°ν‰λ©΄λ„" -p λ¶€μ‚°μ¥μ•_ν”„λ΅μ νΈλ„λ©΄ -n 5

# LLM λ‹µλ³€ μ—†μ΄ κ²€μƒ‰λ§
python query_rag.py "ν™”μ¥μ‹¤ λ°°μΉλ„" --no_llm

# μ‚¬μ© κ°€λ¥ν• ν”„λ΅μ νΈ λ©λ΅ ν™•μΈ
python query_rag.py --list_projects
```

### 4. λ…ΈνΈλ¶ μΈν„°νμ΄μ¤

```python
# Jupyter λ…ΈνΈλ¶μ—μ„ μ‚¬μ©
from chatbot import simple_ask

# κ°„λ‹¨ν• μ§μ
simple_ask("κµ¬μ΅°ν‰λ©΄λ„μ— λ€ν•΄ μ•λ ¤μ£Όμ„Έμ”")

# νΉμ • ν”„λ΅μ νΈ, μ΄λ―Έμ§€ ν¬ν•¨
simple_ask("μ§€ν•μ£Όμ°¨μ¥ λ°°μΉλ” μ–΄λ–»κ² λλ‚μ”?", 
          project="λ¶€μ‚°μ¥μ•_ν”„λ΅μ νΈλ„λ©΄", 
          show_images=True)
```

## β¨ μ£Όμ” κ°μ„ μ‚¬ν•­

- **OpenAI ν†µν•©**: λ†’μ€ ν’μ§μ μ„λ² λ”©κ³Ό LLM λ‹µλ³€
- **μ΄λ―Έμ§€ μ—°λ™**: κ²€μƒ‰ κ²°κ³Όμ™€ κ΄€λ ¨λ λ„λ©΄ μ΄λ―Έμ§€ μλ™ ν‘μ‹  
- **ν”„λ΅μ νΈλ³„ κ΄€λ¦¬**: κ° ν”„λ΅μ νΈλ¥Ό λ…λ¦½μ μΈ μ»¬λ ‰μ…μΌλ΅ κµ¬μ„±
- **ν†µν•© μΈν„°νμ΄μ¤**: CLIμ™€ λ…ΈνΈλ¶ λ¨λ‘μ—μ„ λ™μΌν• κΈ°λ¥ μ‚¬μ©

- **λ©΄μ  κΈ°λ° κ²€μƒ‰**: "κ±΄μ¶•λ©΄μ μ΄ 500γ΅ μ΄μƒμΈ κ±΄λ¬Ό"
- **μΈµμ κΈ°λ° κ²€μƒ‰**: "3μΈµ μ΄μƒμΈ κ±΄μ¶•λ¬Ό"
- **κ±΄λ¬Ό μ ν•**: "μ•„ννΈ μ ν•μ κ±΄μ¶•λ¬Ό"
- **λ³µν•© μ΅°κ±΄**: "λ©΄μ μ΄ 1000γ΅ μ΄μƒμ΄κ³  5μΈµ μ΄ν•μΈ κ±΄λ¬Ό"

### 4. LangSmith μ¶”μ  ν™•μΈ

```bash
# LangSmith μ›Ή μ½μ†”μ—μ„ μ¶”μ  κ²°κ³Ό ν™•μΈ
# https://smith.langchain.com/projects
```

## π“ ν”„λ΅μ νΈ κµ¬μ΅°

```
VLM/
β”β”€β”€ build_rag_db.py          # RAG λ°μ΄ν„°λ² μ΄μ¤ κµ¬μ¶• μ¤ν¬λ¦½νΈ
β”β”€β”€ query_rag.py             # RAG μ§μ μ‹¤ν–‰ μ¤ν¬λ¦½νΈ
β”β”€β”€ requirements.txt         # Python μμ΅΄μ„±
β”β”€β”€ .env.example            # ν™κ²½λ³€μ ν…ν”λ¦Ώ
β”β”€β”€ src/                    # μ†μ¤ μ½”λ“
β”‚   β”β”€β”€ self_query_config.py      # Self-Query μ„¤μ •
β”‚   β”β”€β”€ convert_to_self_query.py  # λ©”νƒ€λ°μ΄ν„° λ³€ν™
β”‚   β”β”€β”€ llm_metadata_extractor.py # λ©”νƒ€λ°μ΄ν„° μ¶”μ¶
β”‚   β”β”€β”€ metadata_vector_db.py     # λ²΅ν„° DB κ΄€λ¦¬
β”‚   β””β”€β”€ prompt_manager.py         # ν”„λ΅¬ν”„νΈ κ΄€λ¦¬
β”β”€β”€ prompts/                # AI ν”„λ΅¬ν”„νΈ
β”‚   β”β”€β”€ metadata_extraction.yaml      # λ©”νƒ€λ°μ΄ν„° μ¶”μ¶ ν”„λ΅¬ν”„νΈ
β”‚   β”β”€β”€ metadata_extraction.yaml      # ν†µν•© λ©”νƒ€λ°μ΄ν„° μ¶”μ¶ ν”„λ΅¬ν”„νΈ
β”‚   β””β”€β”€ rag_query.yaml              # RAG μ§μ ν”„λ΅¬ν”„νΈ
β”β”€β”€ uploads/                # PDF μ—…λ΅λ“ ν΄λ”
β””β”€β”€ chroma_db/             # ChromaDB λ°μ΄ν„°
```

## π”§ κΈ°μ  μ¤νƒ

- **LangChain**: RAG νμ΄ν”„λΌμΈ κµ¬μ¶•
- **ChromaDB**: λ²΅ν„° λ°μ΄ν„°λ² μ΄μ¤
- **Ollama**: λ΅μ»¬ LLM μ‹¤ν–‰
- **LangSmith**: AI λ¨λΈ μ¶”μ  λ° λ¨λ‹ν„°λ§
- **Sentence Transformers**: ν…μ¤νΈ μ„λ² λ”©
- **PyMuPDF**: PDF λ¬Έμ„ μ²λ¦¬

## π“‹ μ”κµ¬μ‚¬ν•­

- Python 3.8+
- Ollama (λ΅μ»¬ LLM μ„λ²„)
- 8GB+ RAM (κ¶μ¥)
- LangSmith API ν‚¤ (μ„ νƒμ‚¬ν•­)

## π¤ κΈ°μ—¬ λ°©λ²•

1. ν”„λ΅μ νΈλ¥Ό ν¬ν¬ν•©λ‹λ‹¤
2. κΈ°λ¥ λΈλμΉλ¥Ό μƒμ„±ν•©λ‹λ‹¤ (`git checkout -b feature/AmazingFeature`)
3. λ³€κ²½μ‚¬ν•­μ„ μ»¤λ°‹ν•©λ‹λ‹¤ (`git commit -m 'Add some AmazingFeature'`)
4. λΈλμΉμ— ν‘Έμ‹ν•©λ‹λ‹¤ (`git push origin feature/AmazingFeature`)
5. Pull Requestλ¥Ό μƒμ„±ν•©λ‹λ‹¤

## π“„ λΌμ΄μ„ μ¤

μ΄ ν”„λ΅μ νΈλ” MIT λΌμ΄μ„ μ¤λ¥Ό λ”°λ¦…λ‹λ‹¤. μμ„Έν• λ‚΄μ©μ€ [LICENSE](LICENSE) νμΌμ„ μ°Έμ΅°ν•μ„Έμ”.

---

**μµκ·Ό μ—…λ°μ΄νΈ**: 2025λ…„ 6μ›” 19μΌ  
**λ²„μ „**: v2.0 (Self-Query RAG)  
**μƒνƒ**: ν”„λ΅λ•μ… μ¤€λΉ„ μ™„λ£
