name: "PDF ë©”íƒ€ë°ì´í„°Â·êµ¬ì¡°ë„ë©´Â·ì¼ëŒí‘œÂ·ê°œìš” ì™„ì „ ì¶”ì¶œ"
type: "metadata_extraction"
description: >
  CAD ì‘ì„± â€˜ê¸°ë‘¥Â·ìŠ¬ë˜ë¸Œ ì¼ëŒí‘œâ€™, â€˜ì„¤ê³„ê°œìš”â€™, â€˜êµ¬ì¡°í‰ë©´ë„(ì§€í•˜ì£¼ì°¨ì¥ ê¸°ì´ˆ ë“±)â€™,
  â€˜ê¸°ì´ˆ ì¼ëŒí‘œâ€™, â€˜ë°í¬ ìŠ¬ë˜ë¸Œ ì¼ëŒí‘œâ€™, â€˜ë³´ ì¼ëŒí‘œâ€™, â€˜ë™ë³„Â·ì¸µë³„ ê°œìš”â€™ PDFë¥¼
  unstructuredPDFLoader(hi_res, infer_table_structure=True)ë¡œ íŒŒì‹±í•œ ë’¤,
  **í…ìŠ¤íŠ¸Â·HTMLÂ·í…Œì´ë¸”Â·ì´ë¯¸ì§€Â·ë„ë©´ OCR** ë°ì´í„°ë¥¼ ëª¨ë‘ í™œìš©í•˜ì—¬
  ì™„ì „í•œ JSON ë©”íƒ€ë°ì´í„°ì™€ êµ¬ì¡°ì¼ëŒí‘œ, ê°œìš”í‘œë¥¼ ìƒì„±í•˜ëŠ” ê³ ê¸‰ í”„ë¡¬í”„íŠ¸.
used_by:
  - "llm_metadata_extractor.py"
input_params:
  - "file_name"
  - "page_number"
  - "text_content"
  - "html_content"
  - "tables_data"
  - "has_images"
output_format: "JSON (Self-Query í˜¸í™˜ + êµ¬ì¡°ë„ë©´Â·ì¼ëŒí‘œÂ·ê°œìš” í¬í•¨)"
version: "1.3"
template: |
  ë‹¹ì‹ ì€ ê³µë™ì£¼íƒ ì„¤ê³„ë„ì„œ PDFì—ì„œ **ë©”íƒ€ë°ì´í„°**, **êµ¬ì¡°ë„ë©´ ì •ë³´**,
  **êµ¬ì¡°Â·ìŠ¬ë˜ë¸ŒÂ·ë³´ ì¼ëŒí‘œ**, **ë™ë³„Â·ì¸µë³„ ê°œìš”í‘œ**ë¥¼ ëˆ„ë½ ì—†ì´ ì¶”ì¶œí•˜ëŠ” ì „ë¬¸ê°€ì…ë‹ˆë‹¤.

  ## ğŸš¨ ì ˆëŒ€ ê·œì¹™
  1. **í…ìŠ¤íŠ¸ Â· HTML Â· í…Œì´ë¸” Â· ì´ë¯¸ì§€(ë„ë©´) OCR** ë°ì´í„°ë¥¼ ëª¨ë‘ ë¶„ì„í•  ê²ƒ.
  2. Self-Query Retriever í˜¸í™˜ JSON êµ¬ì¡°ë¡œë§Œ ì¶œë ¥í•˜ë©°, **header / content / metadata / detailed_data**ë¥¼ ëª…í™•íˆ ë¶„ë¦¬í•  ê²ƒ.
  3. headerÂ·metadata í•„ë“œëŠ” ê²€ìƒ‰Â·í•„í„°ë§ ê°€ëŠ¥í•œ íƒ€ì…(string, integer, float, boolean)ìœ¼ë¡œ ë³€í™˜í•  ê²ƒ.
  4. ìœ íš¨í•œ JSON ì™¸ ë‹¤ë¥¸ í…ìŠ¤íŠ¸(ì„¤ëª…Â·ì£¼ì„) ì ˆëŒ€ í¬í•¨ ê¸ˆì§€.

  ---

  ## ğŸ“‹ header (ë„ë©´ ì¼ë°˜ ì •ë³´)
  - drawing_number: string  
  - drawing_title: string  
  - project_title: string  
  - project_code: string  
  - date_issued: string (ISO 8601)  
  - revision: string  
  - sheet_number: string  
  - scale: string  
  - drawn_by: string  
  - checked_by: string  
  - approved_by: string  
  - notes: string  

  ## ğŸ”– metadata (ê²€ìƒ‰Â·í•„í„°ë§ìš©)
  - drawing_type: string  
  - document_type: string  
  - project_name: string  
  - site_location: string  
  - page_number: integer  
  - has_tables: boolean  
  - has_images: boolean  
  - completion_score: integer  
  - â€¦ (ê¸°ì¡´ Self-Query í•„ë“œ ëª¨ë‘)

  ## ğŸ— detailed_data
  ### â€¢ êµ¬ì¡°í‰ë©´ë„ (structural_plan)
  - grid_lines: [string,â€¦]  
  - foundation_elements: [{{type, mark, size, reinforcement, load_capacity}}, â€¦]  
  - additional_notes: string  

  ### â€¢ êµ¬ì¡°ìš”ì†Œ (structural_elements)
  - type: "ê¸°ë‘¥|ë³´|ìŠ¬ë˜ë¸Œ|ê¸°ì´ˆ í‰íŒ|íŒŒì¼ ê¸°ì´ˆ"  
  - location: string (ê·¸ë¦¬ë“œ ì¢Œí‘œ)  
  - size/thickness: number  
  - reinforcement: string  

  ### â€¢ ê¸°ì´ˆ ì¼ëŒí‘œ (foundation_schedule)
  - id: string  
  - size(BxD): string  
  - top_bar: string  
  - bot_bar: string  
  - stirrup: string  
  - skin_bar: string  
  - comment: string  

  ### â€¢ ë°í¬ ìŠ¬ë˜ë¸Œ ì¼ëŒí‘œ (slab_schedule)
  - detail_id: string  
  - slab_thickness: number  
  - reinforcement: string  
  - end_details: string  

  ### â€¢ ë³´ ì¼ëŒí‘œ (beam_schedule)
  - id: string  
  - shape: string  
  - size(BxD): string  
  - top_bar: string  
  - bot_bar: string  
  - stirrup: string  
  - skin_bar: string  
  - comment: string  

  ### â€¢ ë™ë³„Â·ì¸µë³„ ê°œìš”í‘œ (unit_floor_overview)
  - building: string  
  - max_floors: integer  
  - unit_count: integer  
  - underground_floors: integer  
  - floor_areas: {{floor_name: number, â€¦}}  
  - total_floor_area: number  

  ---

  ## âš™ï¸ JSON ì¶œë ¥ ì˜ˆì‹œ

  ```json
  {{
    "header": {{
      "drawing_number": "S08-532",
      "drawing_title": "ì§€í•˜ì£¼ì°¨ì¥ PC ë³´ ì¼ëŒí‘œ-2",
      "project_title": "ë¶€ì‚°ì¥ì•ˆ í”„ë¡œì íŠ¸",
      "project_code": "S08",
      "date_issued": "2024-06-19",
      "revision": "01",
      "sheet_number": "532",
      "scale": "1:100",
      "drawn_by": "ì„¤ê³„ì",
      "checked_by": "ê²€í† ì",
      "approved_by": "ìŠ¹ì¸ì",
      "notes": "PC ë³´ êµ¬ì¡° ì¼ëŒí‘œ"
    }},
    "content": "ì§€í•˜ì£¼ì°¨ì¥ PC ë³´ ì¼ëŒí‘œë¡œ ê°ì¢… ë³´ì˜ ê·œê²©ê³¼ ì² ê·¼ ë°°ì¹˜ ì •ë³´ë¥¼ í¬í•¨í•©ë‹ˆë‹¤.",
    "metadata": {{
      "drawing_type": "êµ¬ì¡°ë„ë©´",
      "document_type": "ì¼ëŒí‘œ",
      "project_name": "ë¶€ì‚°ì¥ì•ˆ",
      "site_location": "ë¶€ì‚°",
      "page_number": 1,
      "has_tables": true,
      "has_images": false,
      "completion_score": 95
    }},
    "detailed_data": {{
      "structural_elements": [
        {{
          "type": "ë³´",
          "location": "B1-A1",
          "size": "400x600",
          "reinforcement": "D19-4",
          "load_capacity": "500kN"
        }}
      ],
      "beam_schedule": [
        {{
          "id": "GB1",
          "shape": "ì§ì‚¬ê°í˜•",
          "size": "400x600",
          "top_bar": "4-D19",
          "bot_bar": "3-D16",
          "stirrup": "D10@200",
          "skin_bar": "D13@300",
          "comment": "ì¼ë°˜ ë³´"
        }}
      ]
    }}
  }}
  ```

  ---

  ## ğŸ“Š ì…ë ¥ ë°ì´í„° ë¶„ì„

  **íŒŒì¼ëª…**: {file_name}
  **í˜ì´ì§€**: {page_number}
  **ì´ë¯¸ì§€ í¬í•¨**: {has_images}

  ### ğŸ“ í…ìŠ¤íŠ¸ ë‚´ìš©
  ```
  {text_content}
  ```

  ### ğŸŒ HTML ë‚´ìš©
  ```
  {html_content}
  ```

  ### ğŸ“‹ í…Œì´ë¸” ë°ì´í„°
  ```
  {tables_data}
  ```

  ---

  ìœ„ ë°ì´í„°ë¥¼ ëª¨ë‘ ë¶„ì„í•˜ì—¬ ì™„ì „í•œ JSON ë©”íƒ€ë°ì´í„°ë¥¼ ìƒì„±í•˜ì„¸ìš”. **JSONë§Œ ì¶œë ¥í•˜ê³  ë‹¤ë¥¸ ì„¤ëª…ì€ í¬í•¨í•˜ì§€ ë§ˆì„¸ìš”.**