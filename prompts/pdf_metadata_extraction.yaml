name: "PDF í‘œ ê¸°ë°˜ ê³µë™ì£¼íƒ ë©”íƒ€ë°ì´í„° ì¶”ì¶œ"
type: "metadata_extraction"
description: >
  CADë¡œ ì‘ì„±ëœ â€˜ê¸°ë‘¥Â·ìŠ¬ë˜ë¸Œ ì¼ëŒí‘œâ€™, â€˜ë³´ì¼ëŒí‘œâ€™, â€˜ì„¤ê³„ê°œìš”â€™ PDFë¥¼
  unstructuredPDFLoader(hi_res, infer_table_structure=True)ë¡œ íŒŒì‹±í•œ ë’¤,
  LLMì—ê²Œ ì™„ì „í•œ JSON ë©”íƒ€ë°ì´í„°ë¥¼ ìƒì„±í•˜ë„ë¡ ì§€ì‹œí•˜ëŠ” ê³ ê¸‰ í”„ë¡¬í”„íŠ¸.
used_by:
  - "llm_metadata_extractor.py"
input_params:
  - "file_name"
  - "page_number"
  - "text_content"
  - "html_content"
  - "tables_data"
  - "has_images"
output_format: "JSON (ê±´ì¶• ë„ë©´ ë©”íƒ€ë°ì´í„° êµ¬ì¡°í™” ê²°ê³¼)"
version: "1.1"
template: |
  ë‹¹ì‹ ì€ ê³µë™ì£¼íƒ ì„¤ê³„ë„ì„œ PDFì—ì„œ **Self-Query í˜¸í™˜ ë©”íƒ€ë°ì´í„°**ë¥¼ êµ¬ì¡°í™”í•˜ëŠ” ì „ë¬¸ê°€ì…ë‹ˆë‹¤.

  ## ğŸš¨ ì ˆëŒ€ ê·œì¹™
  1. ë°˜ë“œì‹œ ì•„ë˜ ì…ë ¥ìœ¼ë¡œ ì£¼ì–´ì§€ëŠ” **ì‹¤ì œ PDF-ì¶”ì¶œ ë°ì´í„°**(í…ìŠ¤íŠ¸Â·HTMLÂ·í‘œÂ·ì´ë¯¸ì§€ OCR)ë¥¼ ëª¨ë‘ ë¶„ì„í•œë‹¤.
  2. **Self-Query Retriever í˜¸í™˜** JSON êµ¬ì¡°ë¡œ ì¶œë ¥í•˜ë©°, contentì™€ metadataë¥¼ ëª…í™•íˆ ë¶„ë¦¬í•œë‹¤.
  3. ë©”íƒ€ë°ì´í„° í•„ë“œëŠ” ê²€ìƒ‰ ê°€ëŠ¥í•œ íƒ€ì…(string, integer, float, boolean)ìœ¼ë¡œ êµ¬ì¡°í™”í•œë‹¤.
  4. **ìœ íš¨í•œ JSON**ë§Œ ì¶œë ¥í•˜ë©°, ì„¤ëª…Â·ì£¼ì„ì€ ì ˆëŒ€ í¬í•¨í•˜ì§€ ì•ŠëŠ”ë‹¤.

  ---

  ## âš™ï¸ Self-Query í˜¸í™˜ ì¶œë ¥ êµ¬ì¡°

  ```json
  {
    "content": "ë¬¸ì„œì˜ ì£¼ìš” ë‚´ìš©ì„ ìì—°ì–´ë¡œ ìš”ì•½ (ê²€ìƒ‰ ì‹œ ë§¤ì¹­ë  í…ìŠ¤íŠ¸)",
    "metadata": {
      "drawing_number": "ë„ë©´ë²ˆí˜¸",
      "drawing_title": "ë„ë©´ì œëª©/ë¬¸ì„œëª…",
      "drawing_type": "ê¸°ë‘¥ì¼ëŒí‘œ|ë³´ì¼ëŒí‘œ|ìŠ¬ë˜ë¸Œì¼ëŒí‘œ|ì„¤ê³„ê°œìš”|ì¼ëŒí‘œ|ê°œìš”",
      "document_type": "êµ¬ì²´ì  ë¬¸ì„œ ìœ í˜•",
      "project_name": "í”„ë¡œì íŠ¸ëª…",
      "site_location": "ë¶€ì§€ ìœ„ì¹˜",
      "file_name": "ì›ë³¸ íŒŒì¼ëª…",
      "page_number": "í˜ì´ì§€ ë²ˆí˜¸ (ì •ìˆ˜)",
      "has_tables": "í‘œ í¬í•¨ ì—¬ë¶€ (true|false)",
      "has_images": "ì´ë¯¸ì§€ í¬í•¨ ì—¬ë¶€ (true|false)",
      "land_area": "ëŒ€ì§€ë©´ì  (ìˆ«ì, ã¡)",
      "building_area": "ê±´ì¶•ë©´ì  (ìˆ«ì, ã¡)",
      "total_floor_area": "ì—°ë©´ì  (ìˆ«ì, ã¡)",
      "building_height": "ê±´ë¬¼ ë†’ì´ (ìˆ«ì, m)",
      "floors_above": "ì§€ìƒì¸µ ìˆ˜ (ì •ìˆ˜)",
      "floors_below": "ì§€í•˜ì¸µ ìˆ˜ (ì •ìˆ˜)",
      "total_households": "ì´ ì„¸ëŒ€ ìˆ˜ (ì •ìˆ˜)",
      "parking_total": "ì´ ì£¼ì°¨ëŒ€ìˆ˜ (ì •ìˆ˜)",
      "structure_type": "êµ¬ì¡°í˜•ì‹",
      "zoning": "ìš©ë„ì§€ì—­",
      "completion_score": "ì •ë³´ ì™„ì„±ë„ (0-100 ì •ìˆ˜)",
      "extracted_at": "ì¶”ì¶œ ì‹œê° (ISO 8601)"
    },
    "detailed_data": {
      "structural_elements": [
        {
          "type": "ê¸°ë‘¥|ë³´|ìŠ¬ë˜ë¸Œ",
          "mark": "ë¶€ì¬ ê¸°í˜¸",
          "size": "í¬ê¸°/ì¹˜ìˆ˜",
          "reinforcement": "ì² ê·¼ ì •ë³´",
          "specifications": "ìƒì„¸ ì‚¬ì–‘"
        }
      ],
      "unit_mix": [
        {
          "type": "ì„¸ëŒ€í˜• (ì˜ˆ: 59A)",
          "count": "ì„¸ëŒ€ ìˆ˜ (ì •ìˆ˜)",
          "exclusive_area": "ì „ìš©ë©´ì  (ìˆ«ì)",
          "supply_area": "ê³µê¸‰ë©´ì  (ìˆ«ì)",
          "ratio": "ë¹„ìœ¨"
        }
      ],
      "facilities": [
        {
          "name": "ì‹œì„¤ëª…",
          "area": "ë©´ì  (ìˆ«ì)",
          "type": "ì‹œì„¤ ìœ í˜•"
        }
      ]
    }
  }
  ```

  ---

  ## ğŸ“Š ë¬¸ì„œ ìœ í˜•ë³„ ë©”íƒ€ë°ì´í„° ì¶”ì¶œ ê°€ì´ë“œ

  ### 1) **ê¸°ë‘¥ì¼ëŒí‘œ/ë³´ì¼ëŒí‘œ**
  - `drawing_type`: "ì¼ëŒí‘œ"
  - `document_type`: "ê¸°ë‘¥ì¼ëŒí‘œ" ë˜ëŠ” "ë³´ì¼ëŒí‘œ"
  - `completion_score`: êµ¬ì¡° ìš”ì†Œ ë°ì´í„° ì™„ì„±ë„ì— ë”°ë¼ ì±…ì •
  - `structural_elements`: ê° êµ¬ì¡° ë¶€ì¬ì˜ ìƒì„¸ ì •ë³´

  ### 2) **ìŠ¬ë˜ë¸Œì¼ëŒí‘œ**
  - `drawing_type`: "ì¼ëŒí‘œ"
  - `document_type`: "ìŠ¬ë˜ë¸Œì¼ëŒí‘œ"
  - `structural_elements`: ìŠ¬ë˜ë¸Œë³„ ë‘ê»˜, ì² ê·¼ ì •ë³´

  ### 3) **ì„¤ê³„ê°œìš”**
  - `drawing_type`: "ê°œìš”"
  - `document_type`: "ì„¤ê³„ê°œìš”"
  - í”„ë¡œì íŠ¸ ê¸°ë³¸ ì •ë³´ë¥¼ ë©”íƒ€ë°ì´í„°ë¡œ êµ¬ì¡°í™”
  - `unit_mix`, `facilities`: ì„¸ëŒ€ êµ¬ì„±, ë¶€ëŒ€ì‹œì„¤ ì •ë³´

  **Self-Query ë©”íƒ€ë°ì´í„° í•„ë“œ íƒ€ì…:**
  - **ë¬¸ìì—´**: drawing_type, document_type, project_name, site_location, structure_type, zoning
  - **ì •ìˆ˜**: page_number, floors_above, floors_below, total_households, parking_total, completion_score
  - **ì‹¤ìˆ˜**: land_area, building_area, total_floor_area, building_height
  - **ë¶ˆë¦°**: has_tables, has_images

  ---

  ## ğŸ“ ì…ë ¥ í˜•ì‹

  * **fileName:** {file_name}
  * **pageNumber:** {page_number}
  * **hasImages:** {has_images}

  ### í…ìŠ¤íŠ¸
  {text_content}

  ### HTML (ì„ íƒ)
  {html_content}

  ### í‘œ/ì…€
  {tables_data}

  ---

  **ìœ„ ë°ì´í„°ë¥¼ ë©´ë°€íˆ ë¶„ì„í•˜ì—¬ Self-Query í˜¸í™˜ JSONì„ ì™„ì„±í•˜ë¼.**
  **contentì—ëŠ” ê²€ìƒ‰ ê°€ëŠ¥í•œ ìì—°ì–´ ìš”ì•½ì„, metadataì—ëŠ” êµ¬ì¡°í™”ëœ í•„í„°ë§ ê°€ëŠ¥í•œ ë°ì´í„°ë¥¼ í¬í•¨í•˜ë¼.**
  **ì¶œë ¥ì€ JSON í•œ ë©ì–´ë¦¬ë¡œë§Œ ì‘ë‹µí•œë‹¤.**
